function hook_log(){
    var Log = Java.use("android.util.Log");
    var threadef = Java.use('java.lang.Thread');
    var threadinstance = threadef.$new();

    var logMethods = ['d', 'e', 'i', 'v', 'w'];

    logMethods.forEach(function(method, i) {
        Log[method].overload('java.lang.String','java.lang.String').implementation = function(tag, msg) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "log", "method": "Log."+method+"('java.lang.String','java.lang.String')", "tag": tag, "message" : msg, 'stack': Where(stack)};
            send(JSON.stringify(obj));
            var ret = this[method](tag, msg);
            return ret;
        }
        Log[method].overload('java.lang.String','java.lang.String','java.lang.Throwable').implementation = function(tag, msg, th) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "log", "method":"Log."+method+"('java.lang.String','java.lang.String','java.lang.Throwable')", "tag": tag, "message" : msg, 'stack': Where(stack)};
            send(JSON.stringify(obj));
            var ret = this[method](tag, msg, th);
            return ret;
        } 
    });
}

hook_log();