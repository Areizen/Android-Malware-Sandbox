function base64Hook(){
    var base64 = Java.use('android.util.Base64');
    var threadef = Java.use('java.lang.Thread');
    var threadinstance = threadef.$new();

    base64.decode.overload('java.lang.String', 'int').implementation = function(str, flag) {
        var result = this.decode(str, flag);
        if (result.length != 0) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "base64", "method" : "Base64.decode('java.lang.String', 'int')", 'stack': common_functions.Where(stack)};
            send(JSON.stringify(obj), new Uint8Array(result));
        }
        return result;
    }
    base64.decode.overload('[B', 'int').implementation = function(input, flag) {
        var result = this.decode(input, flag);
        if (result.length != 0) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "base64", "method" : "Base64.decode('[B', 'int')", 'stack': common_functions.Where(stack)};
            send(JSON.stringify(obj), new Uint8Array(result));
        }
        return result;
    }
    base64.decode.overload('[B', 'int', 'int', 'int').implementation = function(input, offset, len, flags){
        var result = this.decode(input, offset, len, flags);
        if (result.length != 0) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "base64", "method" : "Base64.decode('[B', 'int', 'int', 'int')", 'stack': common_functions.Where(stack)};
            send(JSON.stringify(obj), new Uint8Array(result));
        }
        return result;
    }
    base64.encode.overload('[B', 'int').implementation = function(input, flags) {
        var result = this.encode(input, flags);
        if (input.length != 0) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "base64", "method" : "Base64.encode('[B', 'int')", 'stack': common_functions.Where(stack)};
            send(JSON.stringify(obj), new Uint8Array(input));
        }
        return result;
    }
    base64.encode.overload('[B', 'int', 'int', 'int').implementation = function(input, offset, len, flags){
        var result = this.encode(input, offset, len, flags);
        if (input.length != 0) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "base64", "method" : "Base64.encode('[B', 'int', 'int', 'int')", 'stack': common_functions.Where(stack)};
            send(JSON.stringify(obj), new Uint8Array(input));
        }
        return result;
    }
    base64.encodeToString.overload('[B', 'int', 'int', 'int').implementation = function(input, offset, len, flags){
        var result = this.encodeToString(input, offset, len, flags);
        if (input.length != 0) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "base64", "method" : "Base64.encodeToString('[B', 'int', 'int', 'int')",'stack': common_functions.Where(stack)};
            send(JSON.stringify(obj), new Uint8Array(input));
        }
        return result;
    }
    base64.encodeToString.overload('[B', 'int').implementation = function(input, flags){
        var result = this.encodeToString(input, flags);
        if (input.length != 0) {
            var stack = threadinstance.currentThread().getStackTrace();
            var obj = {"plugin": "base64", "method" : "Base64.encodeToString('[B', 'int')",'stack': common_functions.Where(stack)};
            send(JSON.stringify(obj), new Uint8Array(input));
        }
        return result;
    }
}

base64Hook();